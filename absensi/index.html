<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ“š LesKu - Sistem Absensi Modern</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --accent: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e1b4b;
            --light: #f8fafc;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .bg-animation .circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(236, 72, 153, 0.3));
            animation: float 20s infinite;
            filter: blur(40px);
        }

        .bg-animation .circle:nth-child(1) {
            width: 500px;
            height: 500px;
            top: -100px;
            right: -100px;
            animation-delay: 0s;
        }

        .bg-animation .circle:nth-child(2) {
            width: 400px;
            height: 400px;
            bottom: -50px;
            left: -50px;
            animation-delay: -5s;
        }

        .bg-animation .circle:nth-child(3) {
            width: 300px;
            height: 300px;
            top: 50%;
            left: 50%;
            animation-delay: -10s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(50px, 50px) rotate(90deg); }
            50% { transform: translate(0, 100px) rotate(180deg); }
            75% { transform: translate(-50px, 50px) rotate(270deg); }
        }

        /* Layout */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 30px 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 2rem;
            color: white;
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 10px 40px rgba(99, 102, 241, 0.4); }
            50% { box-shadow: 0 10px 60px rgba(99, 102, 241, 0.6); }
        }

        .sidebar-header h1 {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .sidebar-header p {
            color: rgba(255,255,255,0.6);
            font-size: 0.85rem;
        }

        /* Live Clock */
        .live-clock {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .live-clock .time {
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: 2px;
        }

        .live-clock .date {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 5px;
        }

        /* Navigation */
        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
            font-weight: 500;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            transform: translateX(5px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4);
        }

        .nav-link i {
            width: 24px;
            font-size: 1.1rem;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            min-height: 100vh;
        }

        /* Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .page-title h2 {
            color: white;
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .page-title p {
            color: rgba(255,255,255,0.6);
            margin-top: 5px;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .stat-card .icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .stat-card.total .icon { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; }
        .stat-card.hadir .icon { background: linear-gradient(135deg, #10b981, #34d399); color: white; }
        .stat-card.izin .icon { background: linear-gradient(135deg, #f59e0b, #fbbf24); color: white; }
        .stat-card.alpha .icon { background: linear-gradient(135deg, #ef4444, #f87171); color: white; }

        .stat-card h3 {
            color: white;
            font-size: 2.2rem;
            font-weight: 700;
        }

        .stat-card p {
            color: rgba(255,255,255,0.7);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .stat-card .trend {
            position: absolute;
            top: 25px;
            right: 25px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .stat-card .trend.up { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .stat-card .trend.down { background: rgba(239, 68, 68, 0.2); color: #ef4444; }

        /* Glass Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 30px;
            margin-bottom: 25px;
            animation: fadeInUp 0.5s ease;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .card-header .title {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .card-header .title i {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 0.95rem;
            font-family: inherit;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.5);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #34d399);
            color: white;
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #fbbf24);
            color: white;
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #f87171);
            color: white;
            box-shadow: 0 5px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-glass {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid var(--glass-border);
        }

        .btn-glass:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85rem;
            border-radius: 10px;
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
        }

        .form-group label .required {
            color: var(--danger);
        }

        .form-control {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            color: white;
            transition: all 0.3s ease;
        }

        .form-control::placeholder {
            color: rgba(255,255,255,0.4);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(255,255,255,0.12);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
        }

        .form-control option {
            background: var(--dark);
            color: white;
        }

        /* Time Inputs Group */
        .time-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .time-group .separator {
            color: rgba(255,255,255,0.6);
            font-size: 1.2rem;
        }

        .time-group .form-control {
            flex: 1;
        }

        /* Schedule Card */
        .schedule-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .schedule-card:hover {
            transform: translateX(5px);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.3), rgba(139, 92, 246, 0.3));
        }

        .schedule-card .time-badge {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            padding: 15px 20px;
            border-radius: 12px;
            text-align: center;
            min-width: 120px;
        }

        .schedule-card .time-badge .start {
            font-size: 1.4rem;
            font-weight: 700;
            color: white;
        }

        .schedule-card .time-badge .end {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.8);
        }

        .schedule-card .schedule-info {
            flex: 1;
        }

        .schedule-card .schedule-info h4 {
            color: white;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .schedule-card .schedule-info p {
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
        }

        .schedule-card .schedule-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .schedule-card .schedule-status.active {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .schedule-card .schedule-status.upcoming {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .schedule-card .schedule-status.done {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.5);
        }

        /* Table */
        .table-container {
            overflow-x: auto;
            border-radius: 16px;
            background: rgba(255,255,255,0.03);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 16px 20px;
            text-align: left;
        }

        th {
            background: rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.9);
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            color: rgba(255,255,255,0.8);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        tr:hover td {
            background: rgba(255,255,255,0.03);
        }

        .student-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .student-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 1.1rem;
        }

        .student-details h4 {
            color: white;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .student-details p {
            color: rgba(255,255,255,0.5);
            font-size: 0.8rem;
        }

        /* Badges */
        .badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .badge-hadir {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .badge-izin {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .badge-alpha {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .badge-belum {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.5);
        }

        .badge-kelas {
            background: rgba(99, 102, 241, 0.2);
            color: #a5b4fc;
        }

        /* Action Buttons */
        .action-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .action-btns .btn {
            padding: 8px 14px;
            font-size: 0.8rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeInUp 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        /* Session Timer */
        .session-timer {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.2));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
        }

        .session-timer .info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .session-timer .info i {
            font-size: 2rem;
            color: #10b981;
        }

        .session-timer .info h4 {
            color: white;
            font-size: 1.1rem;
        }

        .session-timer .info p {
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
        }

        .session-timer .countdown {
            background: rgba(16, 185, 129, 0.3);
            padding: 12px 25px;
            border-radius: 12px;
        }

        .session-timer .countdown span {
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255,255,255,0.5);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            color: rgba(255,255,255,0.7);
            margin-bottom: 10px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #1e1b4b, #312e81);
            border: 1px solid var(--glass-border);
            padding: 35px;
            border-radius: 24px;
            max-width: 550px;
            width: 100%;
            animation: modalSlide 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .modal-header h3 {
            color: white;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-close {
            background: rgba(255,255,255,0.1);
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: rgba(255,255,255,0.5);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 16px 28px;
            border-radius: 16px;
            display: none;
            animation: slideInRight 0.4s ease;
            z-index: 1001;
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .toast.success {
            background: linear-gradient(135deg, var(--success), #34d399);
        }

        .toast.error {
            background: linear-gradient(135deg, var(--danger), #f87171);
        }

        .toast.warning {
            background: linear-gradient(135deg, var(--warning), #fbbf24);
        }

        /* Mobile Hamburger */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 200;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 14px;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4);
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: flex-end;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
        }

        .filter-bar .form-group {
            margin-bottom: 0;
            min-width: 180px;
        }

        .filter-bar .form-group label {
            font-size: 0.8rem;
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-bar .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #34d399);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .quick-action-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .quick-action-btn:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-3px);
        }

        .quick-action-btn i {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
        }

        .quick-action-btn div h4 {
            font-size: 1rem;
            margin-bottom: 3px;
        }

        .quick-action-btn div p {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .filter-bar {
                flex-direction: column;
            }

            .filter-bar .form-group {
                width: 100%;
            }

            .action-btns {
                flex-direction: column;
            }

            .action-btns .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .glass-card {
                padding: 20px;
            }

            .page-title h2 {
                font-size: 1.4rem;
            }
        }

        /* Print */
        @media print {
            body {
                background: white;
            }

            .sidebar, .mobile-toggle, .btn, .filter-bar, .nav-menu {
                display: none !important;
            }

            .main-content {
                margin-left: 0;
            }

            .glass-card {
                background: white;
                border: 1px solid #ddd;
            }

            * {
                color: #333 !important;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
    </div>

    <!-- Mobile Toggle -->
    <button class="mobile-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h1>LesKu</h1>
                <p>Sistem Absensi Modern</p>
            </div>

            <div class="live-clock">
                <div class="time" id="liveClock">00:00:00</div>
                <div class="date" id="liveDate">Loading...</div>
            </div>

            <nav>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link active" data-tab="dashboard">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-tab="jadwal">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Jadwal Les</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-tab="absensi">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Absensi</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-tab="murid">
                            <i class="fas fa-user-graduate"></i>
                            <span>Data Murid</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-tab="riwayat">
                            <i class="fas fa-history"></i>
                            <span>Riwayat</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-tab="laporan">
                            <i class="fas fa-chart-pie"></i>
                            <span>Laporan</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Tab -->
            <div id="tab-dashboard" class="tab-content active">
                <div class="page-header">
                    <div class="page-title">
                        <h2><i class="fas fa-sparkles"></i> Selamat Datang!</h2>
                        <p>Kelola absensi murid les dengan mudah dan efisien</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-glass" onclick="exportData()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card total">
                        <span class="trend up"><i class="fas fa-arrow-up"></i> 12%</span>
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <h3 id="statTotalMurid">0</h3>
                        <p>Total Murid</p>
                    </div>
                    <div class="stat-card hadir">
                        <span class="trend up"><i class="fas fa-check"></i></span>
                        <div class="icon"><i class="fas fa-check-circle"></i></div>
                        <h3 id="statHadir">0</h3>
                        <p>Hadir Hari Ini</p>
                    </div>
                    <div class="stat-card izin">
                        <div class="icon"><i class="fas fa-envelope"></i></div>
                        <h3 id="statIzin">0</h3>
                        <p>Izin Hari Ini</p>
                    </div>
                    <div class="stat-card alpha">
                        <div class="icon"><i class="fas fa-times-circle"></i></div>
                        <h3 id="statAlpha">0</h3>
                        <p>Alpha Hari Ini</p>
                    </div>
                </div>

                <!-- Session Timer -->
                <div class="session-timer" id="sessionTimer" style="display: none;">
                    <div class="info">
                        <i class="fas fa-clock"></i>
                        <div>
                            <h4 id="currentSessionName">Sesi Aktif</h4>
                            <p id="currentSessionTime">08:00 - 10:00</p>
                        </div>
                    </div>
                    <div class="countdown">
                        <span id="sessionCountdown">00:00:00</span>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <div class="quick-action-btn" onclick="switchTab('absensi')">
                        <i class="fas fa-clipboard-check"></i>
                        <div>
                            <h4>Mulai Absensi</h4>
                            <p>Absen murid sekarang</p>
                        </div>
                    </div>
                    <div class="quick-action-btn" onclick="switchTab('murid')">
                        <i class="fas fa-user-plus"></i>
                        <div>
                            <h4>Tambah Murid</h4>
                            <p>Daftarkan murid baru</p>
                        </div>
                    </div>
                    <div class="quick-action-btn" onclick="switchTab('jadwal')">
                        <i class="fas fa-calendar-plus"></i>
                        <div>
                            <h4>Atur Jadwal</h4>
                            <p>Kelola jadwal les</p>
                        </div>
                    </div>
                    <div class="quick-action-btn" onclick="switchTab('laporan')">
                        <i class="fas fa-file-alt"></i>
                        <div>
                            <h4>Lihat Laporan</h4>
                            <p>Statistik kehadiran</p>
                        </div>
                    </div>
                </div>

                <!-- Today's Schedule -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-calendar-day"></i>
                            <span>Jadwal Hari Ini</span>
                        </div>
                        <button class="btn btn-glass btn-sm" onclick="switchTab('jadwal')">
                            <i class="fas fa-plus"></i> Tambah
                        </button>
                    </div>
                    <div id="todaySchedules">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Jadwal Tab -->
            <div id="tab-jadwal" class="tab-content">
                <div class="page-header">
                    <div class="page-title">
                        <h2><i class="fas fa-calendar-alt"></i> Jadwal Les</h2>
                        <p>Atur jadwal pertemuan les</p>
                    </div>
                </div>

                <!-- Add Schedule Form -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-plus-circle"></i>
                            <span>Tambah Jadwal Baru</span>
                        </div>
                    </div>
                    <form id="formJadwal">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nama Sesi / Mata Pelajaran <span class="required">*</span></label>
                                <input type="text" class="form-control" id="namaJadwal" placeholder="Contoh: Matematika Dasar" required>
                            </div>
                            <div class="form-group">
                                <label>Kelas <span class="required">*</span></label>
                                <select class="form-control" id="kelasJadwal" required>
                                    <option value="">Pilih Kelas</option>
                                    <option value="Kelas 1">Kelas 1</option>
                                    <option value="Kelas 2">Kelas 2</option>
                                    <option value="Kelas 3">Kelas 3</option>
                                    <option value="Kelas 4">Kelas 4</option>
                                    <option value="Kelas 5">Kelas 5</option>
                                    <option value="Kelas 6">Kelas 6</option>
                                    <option value="SMP">SMP</option>
                                    <option value="SMA">SMA</option>
                                    <option value="Semua">Semua Kelas</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Hari <span class="required">*</span></label>
                                <select class="form-control" id="hariJadwal" required>
                                    <option value="">Pilih Hari</option>
                                    <option value="Senin">Senin</option>
                                    <option value="Selasa">Selasa</option>
                                    <option value="Rabu">Rabu</option>
                                    <option value="Kamis">Kamis</option>
                                    <option value="Jumat">Jumat</option>
                                    <option value="Sabtu">Sabtu</option>
                                    <option value="Minggu">Minggu</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Jam Pertemuan <span class="required">*</span></label>
                                <div class="time-group">
                                    <input type="time" class="form-control" id="jamMulai" required>
                                    <span class="separator">s/d</span>
                                    <input type="time" class="form-control" id="jamSelesai" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Pengajar</label>
                            <input type="text" class="form-control" id="pengajarJadwal" placeholder="Nama pengajar (opsional)">
                        </div>
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Simpan Jadwal
                            </button>
                            <button type="reset" class="btn btn-glass">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Schedule List -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-list"></i>
                            <span>Daftar Jadwal</span>
                        </div>
                    </div>
                    <div id="jadwalList">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Absensi Tab -->
            <div id="tab-absensi" class="tab-content">
                <div class="page-header">
                    <div class="page-title">
                        <h2><i class="fas fa-clipboard-check"></i> Absensi Hari Ini</h2>
                        <p id="absensiDate">Loading...</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-success" onclick="absensiSemuaHadir()">
                            <i class="fas fa-check-double"></i> Semua Hadir
                        </button>
                    </div>
                </div>

                <!-- Select Session -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-clock"></i>
                            <span>Pilih Sesi</span>
                        </div>
                    </div>
                    <div class="filter-bar" style="margin-bottom: 0; background: transparent; padding: 0;">
                        <div class="form-group">
                            <label>Sesi Les</label>
                            <select class="form-control" id="sesiAbsensi" onchange="loadAbsensiSesi()">
                                <option value="">-- Pilih Sesi --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Filter Kelas</label>
                            <select class="form-control" id="filterKelasAbsensi" onchange="tampilkanAbsensi()">
                                <option value="">Semua Kelas</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Session Info -->
                <div id="sesiInfo" class="session-timer" style="display: none;">
                    <div class="info">
                        <i class="fas fa-book-reader"></i>
                        <div>
                            <h4 id="sesiNamaInfo">-</h4>
                            <p id="sesiWaktuInfo">-</p>
                        </div>
                    </div>
                    <span class="badge badge-hadir" id="sesiStatusBadge">
                        <i class="fas fa-circle"></i> Aktif
                    </span>
                </div>

                <!-- Attendance Table -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-user-check"></i>
                            <span>Daftar Hadir</span>
                        </div>
                        <span class="badge badge-kelas" id="totalAbsensi">0 Murid</span>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Murid</th>
                                    <th>Kelas</th>
                                    <th>Status</th>
                                    <th>Jam Absen</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tabelAbsensi">
                            </tbody>
                        </table>
                    </div>
                    <div id="emptyAbsensi" class="empty-state" style="display: none;">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>Pilih Sesi Terlebih Dahulu</h3>
                        <p>Silakan pilih sesi les untuk mulai absensi</p>
                    </div>
                </div>
            </div>

            <!-- Murid Tab -->
            <div id="tab-murid" class="tab-content">
                <div class="page-header">
                    <div class="page-title">
                        <h2><i class="fas fa-user-graduate"></i> Data Murid</h2>
                        <p>Kelola data murid les</p>
                    </div>
                </div>

                <!-- Add Student Form -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-user-plus"></i>
                            <span>Tambah Murid Baru</span>
                        </div>
                    </div>
                    <form id="formMurid">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nama Lengkap <span class="required">*</span></label>
                                <input type="text" class="form-control" id="namaMurid" placeholder="Masukkan nama lengkap" required>
                            </div>
                            <div class="form-group">
                                <label>Kelas <span class="required">*</span></label>
                                <select class="form-control" id="kelasMurid" required>
                                    <option value="">Pilih Kelas</option>
                                    <option value="Kelas 1">Kelas 1</option>
                                    <option value="Kelas 2">Kelas 2</option>
                                    <option value="Kelas 3">Kelas 3</option>
                                    <option value="Kelas 4">Kelas 4</option>
                                    <option value="Kelas 5">Kelas 5</option>
                                    <option value="Kelas 6">Kelas 6</option>
                                    <option value="SMP">SMP</option>
                                    <option value="SMA">SMA</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>No. HP Orang Tua</label>
                                <input type="tel" class="form-control" id="noHpMurid" placeholder="Contoh: 08123456789">
                            </div>
                            <div class="form-group">
                                <label>Alamat</label>
                                <input type="text" class="form-control" id="alamatMurid" placeholder="Alamat tempat tinggal">
                            </div>
                        </div>
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Simpan Murid
                            </button>
                            <button type="reset" class="btn btn-glass">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Student List -->
                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-users"></i>
                            <span>Daftar Murid</span>
                        </div>
                        <span class="badge badge-kelas" id="totalMuridBadge">0 Murid</span>
                    </div>
                    <div class="filter-bar" style="background: transparent; padding: 0;">
                        <div class="form-group">
                            <label>Cari Nama</label>
                            <input type="text" class="form-control" id="searchMurid" placeholder="Ketik nama..." onkeyup="tampilkanMurid()">
                        </div>
                        <div class="form-group">
                            <label>Filter Kelas</label>
                            <select class="form-control" id="filterKelasMurid" onchange="tampilkanMurid()">
                                <option value="">Semua Kelas</option>
                            </select>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Murid</th>
                                    <th>Kelas</th>
                                    <th>No. HP Ortu</th>
                                    <th>Alamat</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tabelMurid">
                            </tbody>
                        </table>
                    </div>
                    <div id="emptyMurid" class="empty-state" style="display: none;">
                        <i class="fas fa-user-plus"></i>
                        <h3>Belum Ada Murid</h3>
                        <p>Tambahkan murid baru menggunakan form di atas</p>
                    </div>
                </div>
            </div>

            <!-- Riwayat Tab -->
            <div id="tab-riwayat" class="tab-content">
                <div class="page-header">
                    <div class="page-title">
                        <h2><i class="fas fa-history"></i> Riwayat Absensi</h2>
                        <p>Lihat semua catatan kehadiran</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-success" onclick="exportRiwayat()">
                            <i class="fas fa-file-excel"></i> Export Excel
                        </button>
                    </div>
                </div>

                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-filter"></i>
                            <span>Filter Data</span>
                        </div>
                    </div>
                    <div class="filter-bar" style="background: transparent; padding: 0;">
                        <div class="form-group">
                            <label>Dari Tanggal</label>
                            <input type="date" class="form-control" id="filterDari">
                        </div>
                        <div class="form-group">
                            <label>Sampai Tanggal</label>
                            <input type="date" class="form-control" id="filterSampai">
                        </div>
                        <div class="form-group">
                            <label>Kelas</label>
                            <select class="form-control" id="filterKelasRiwayat">
                                <option value="">Semua</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select class="form-control" id="filterStatus">
                                <option value="">Semua</option>
                                <option value="hadir">Hadir</option>
                                <option value="izin">Izin</option>
                                <option value="alpha">Alpha</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="filterRiwayat()">
                            <i class="fas fa-search"></i> Cari
                        </button>
                    </div>
                </div>

                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-list-alt"></i>
                            <span>Data Riwayat</span>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Sesi</th>
                                    <th>Murid</th>
                                    <th>Kelas</th>
                                    <th>Status</th>
                                    <th>Jam Absen</th>
                                </tr>
                            </thead>
                            <tbody id="tabelRiwayat">
                            </tbody>
                        </table>
                    </div>
                    <div id="emptyRiwayat" class="empty-state" style="display: none;">
                        <i class="fas fa-calendar-times"></i>
                        <h3>Belum Ada Riwayat</h3>
                        <p>Riwayat akan muncul setelah melakukan absensi</p>
                    </div>
                </div>
            </div>

            <!-- Laporan Tab -->
            <div id="tab-laporan" class="tab-content">
                <div class="page-header">
                    <div class="page-title">
                        <h2><i class="fas fa-chart-pie"></i> Laporan Kehadiran</h2>
                        <p>Statistik dan rekapitulasi absensi</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-success" onclick="exportLaporan()">
                            <i class="fas fa-file-excel"></i> Export
                        </button>
                        <button class="btn btn-warning" onclick="window.print()">
                            <i class="fas fa-print"></i> Cetak
                        </button>
                    </div>
                </div>

                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-calendar"></i>
                            <span>Filter Periode</span>
                        </div>
                    </div>
                    <div class="filter-bar" style="background: transparent; padding: 0;">
                        <div class="form-group">
                            <label>Bulan</label>
                            <input type="month" class="form-control" id="filterBulan">
                        </div>
                        <div class="form-group">
                            <label>Kelas</label>
                            <select class="form-control" id="filterKelasLaporan">
                                <option value="">Semua</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="tampilkanLaporan()">
                            <i class="fas fa-sync"></i> Generate
                        </button>
                    </div>
                </div>

                <div class="glass-card">
                    <div class="card-header">
                        <div class="title">
                            <i class="fas fa-table"></i>
                            <span>Rekap Kehadiran</span>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Murid</th>
                                    <th>Kelas</th>
                                    <th>Hadir</th>
                                    <th>Izin</th>
                                    <th>Alpha</th>
                                    <th>Persentase</th>
                                </tr>
                            </thead>
                            <tbody id="tabelLaporan">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Modal -->
    <div id="modalEdit" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Edit Data Murid</h3>
                <button class="modal-close" onclick="tutupModal('modalEdit')">&times;</button>
            </div>
            <form id="formEditMurid">
                <input type="hidden" id="editId">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" class="form-control" id="editNama" required>
                </div>
                <div class="form-group">
                    <label>Kelas</label>
                    <select class="form-control" id="editKelas" required>
                        <option value="Kelas 1">Kelas 1</option>
                        <option value="Kelas 2">Kelas 2</option>
                        <option value="Kelas 3">Kelas 3</option>
                        <option value="Kelas 4">Kelas 4</option>
                        <option value="Kelas 5">Kelas 5</option>
                        <option value="Kelas 6">Kelas 6</option>
                        <option value="SMP">SMP</option>
                        <option value="SMA">SMA</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>No. HP Orang Tua</label>
                    <input type="tel" class="form-control" id="editNoHp">
                </div>
                <div class="form-group">
                    <label>Alamat</label>
                    <input type="text" class="form-control" id="editAlamat">
                </div>
                <div class="btn-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Update
                    </button>
                    <button type="button" class="btn btn-danger" onclick="tutupModal('modalEdit')">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script>
        // ==================== DATABASE ====================
        let muridList = JSON.parse(localStorage.getItem('muridList')) || [];
        let jadwalList = JSON.parse(localStorage.getItem('jadwalList')) || [];
        let absensiList = JSON.parse(localStorage.getItem('absensiList')) || [];

        // ==================== UTILITY FUNCTIONS ====================
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function getTanggalHariIni() {
            return new Date().toISOString().split('T')[0];
        }

        function getHariIni() {
            const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
            return days[new Date().getDay()];
        }

        function formatTanggal(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(date).toLocaleDateString('id-ID', options);
        }

        function formatTanggalShort(date) {
            return new Date(date).toLocaleDateString('id-ID');
        }

        function getWaktuSekarang() {
            return new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
        }

        function simpanData() {
            localStorage.setItem('muridList', JSON.stringify(muridList));
            localStorage.setItem('jadwalList', JSON.stringify(jadwalList));
            localStorage.setItem('absensiList', JSON.stringify(absensiList));
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : 'exclamation-circle'}"></i> ${message}`;
            toast.className = `toast ${type}`;
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 3000);
        }

        function getInitials(name) {
            return name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
        }

        // ==================== LIVE CLOCK ====================
        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString('id-ID');
            const date = formatTanggal(now);
            
            document.getElementById('liveClock').textContent = time;
            document.getElementById('liveDate').textContent = date;
        }
        setInterval(updateClock, 1000);
        updateClock();

        // ==================== SIDEBAR & NAVIGATION ====================
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function() {
                const tab = this.dataset.tab;
                switchTab(tab);
            });
        });

        function switchTab(tabName) {
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');

            // Close sidebar on mobile
            if (window.innerWidth <= 1024) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }

        // ==================== JADWAL FUNCTIONS ====================
        document.getElementById('formJadwal').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const jadwal = {
                id: generateId(),
                nama: document.getElementById('namaJadwal').value,
                kelas: document.getElementById('kelasJadwal').value,
                hari: document.getElementById('hariJadwal').value,
                jamMulai: document.getElementById('jamMulai').value,
                jamSelesai: document.getElementById('jamSelesai').value,
                pengajar: document.getElementById('pengajarJadwal').value
            };
            
            jadwalList.push(jadwal);
            simpanData();
            showToast('Jadwal berhasil ditambahkan!');
            this.reset();
            tampilkanJadwal();
            updateSesiDropdown();
            tampilkanJadwalHariIni();
        });

        function tampilkanJadwal() {
            const container = document.getElementById('jadwalList');
            
            if (jadwalList.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-calendar-plus"></i>
                        <h3>Belum Ada Jadwal</h3>
                        <p>Tambahkan jadwal baru menggunakan form di atas</p>
                    </div>`;
                return;
            }

            const days = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu'];
            let html = '';

            days.forEach(day => {
                const daySchedules = jadwalList.filter(j => j.hari === day);
                if (daySchedules.length > 0) {
                    html += `<h4 style="color: rgba(255,255,255,0.7); margin: 20px 0 10px; font-size: 0.9rem;">${day}</h4>`;
                    daySchedules.forEach(j => {
                        html += `
                            <div class="schedule-card">
                                <div class="time-badge">
                                    <div class="start">${j.jamMulai}</div>
                                    <div class="end">s/d ${j.jamSelesai}</div>
                                </div>
                                <div class="schedule-info">
                                    <h4>${j.nama}</h4>
                                    <p><i class="fas fa-users"></i> ${j.kelas} ${j.pengajar ? 'â€¢ ' + j.pengajar : ''}</p>
                                </div>
                                <button class="btn btn-danger btn-sm btn-icon" onclick="hapusJadwal('${j.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                    });
                }
            });

            container.innerHTML = html;
        }

        function tampilkanJadwalHariIni() {
            const container = document.getElementById('todaySchedules');
            const hariIni = getHariIni();
            const jadwalHariIni = jadwalList.filter(j => j.hari === hariIni);
            
            if (jadwalHariIni.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="padding: 30px;">
                        <i class="fas fa-calendar-check" style="font-size: 2rem;"></i>
                        <h3>Tidak Ada Jadwal Hari Ini</h3>
                    </div>`;
                return;
            }

            const now = new Date();
            const currentTime = now.getHours() * 60 + now.getMinutes();

            container.innerHTML = jadwalHariIni.map(j => {
                const [startH, startM] = j.jamMulai.split(':').map(Number);
                const [endH, endM] = j.jamSelesai.split(':').map(Number);
                const startTime = startH * 60 + startM;
                const endTime = endH * 60 + endM;

                let status = 'upcoming';
                let statusText = 'Akan Datang';
                
                if (currentTime >= startTime && currentTime <= endTime) {
                    status = 'active';
                    statusText = 'Sedang Berlangsung';
                } else if (currentTime > endTime) {
                    status = 'done';
                    statusText = 'Selesai';
                }

                return `
                    <div class="schedule-card">
                        <div class="time-badge">
                            <div class="start">${j.jamMulai}</div>
                            <div class="end">s/d ${j.jamSelesai}</div>
                        </div>
                        <div class="schedule-info">
                            <h4>${j.nama}</h4>
                            <p><i class="fas fa-users"></i> ${j.kelas}</p>
                        </div>
                        <span class="schedule-status ${status}">${statusText}</span>
                    </div>
                `;
            }).join('');
        }

        function hapusJadwal(id) {
            if (confirm('Hapus jadwal ini?')) {
                jadwalList = jadwalList.filter(j => j.id !== id);
                simpanData();
                showToast('Jadwal dihapus!', 'warning');
                tampilkanJadwal();
                updateSesiDropdown();
                tampilkanJadwalHariIni();
            }
        }

        function updateSesiDropdown() {
            const hariIni = getHariIni();
            const jadwalHariIni = jadwalList.filter(j => j.hari === hariIni);
            const select = document.getElementById('sesiAbsensi');
            
            select.innerHTML = '<option value="">-- Pilih Sesi --</option>' +
                jadwalHariIni.map(j => `
                    <option value="${j.id}">${j.nama} (${j.jamMulai} - ${j.jamSelesai}) - ${j.kelas}</option>
                `).join('');
        }

        // ==================== MURID FUNCTIONS ====================
        document.getElementById('formMurid').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const murid = {
                id: generateId(),
                nama: document.getElementById('namaMurid').value,
                kelas: document.getElementById('kelasMurid').value,
                noHp: document.getElementById('noHpMurid').value,
                alamat: document.getElementById('alamatMurid').value,
                tanggalDaftar: getTanggalHariIni()
            };
            
            muridList.push(murid);
            simpanData();
            showToast('Murid berhasil ditambahkan!');
            this.reset();
            tampilkanMurid();
            updateStats();
            updateFilterKelas();
        });

        function tampilkanMurid() {
            const tbody = document.getElementById('tabelMurid');
            const empty = document.getElementById('emptyMurid');
            const filter = document.getElementById('filterKelasMurid').value;
            const search = document.getElementById('searchMurid').value.toLowerCase();
            
            let filtered = muridList.filter(m => {
                const matchKelas = !filter || m.kelas === filter;
                const matchSearch = m.nama.toLowerCase().includes(search);
                return matchKelas && matchSearch;
            });
            
            document.getElementById('totalMuridBadge').textContent = `${filtered.length} Murid`;
            
            if (filtered.length === 0) {
                tbody.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            tbody.innerHTML = filtered.map((m, i) => `
                <tr>
                    <td>${i + 1}</td>
                    <td>
                        <div class="student-info">
                            <div class="student-avatar">${getInitials(m.nama)}</div>
                            <div class="student-details">
                                <h4>${m.nama}</h4>
                                <p>Bergabung: ${formatTanggalShort(m.tanggalDaftar)}</p>
                            </div>
                        </div>
                    </td>
                    <td><span class="badge badge-kelas">${m.kelas}</span></td>
                    <td>${m.noHp || '-'}</td>
                    <td>${m.alamat || '-'}</td>
                    <td>
                        <div class="action-btns">
                            <button class="btn btn-primary btn-sm btn-icon" onclick="editMurid('${m.id}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-danger btn-sm btn-icon" onclick="hapusMurid('${m.id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function editMurid(id) {
            const m = muridList.find(x => x.id === id);
            if (!m) return;
            
            document.getElementById('editId').value = m.id;
            document.getElementById('editNama').value = m.nama;
            document.getElementById('editKelas').value = m.kelas;
            document.getElementById('editNoHp').value = m.noHp || '';
            document.getElementById('editAlamat').value = m.alamat || '';
            
            document.getElementById('modalEdit').classList.add('active');
        }

        document.getElementById('formEditMurid').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('editId').value;
            const idx = muridList.findIndex(m => m.id === id);
            
            if (idx !== -1) {
                muridList[idx].nama = document.getElementById('editNama').value;
                muridList[idx].kelas = document.getElementById('editKelas').value;
                muridList[idx].noHp = document.getElementById('editNoHp').value;
                muridList[idx].alamat = document.getElementById('editAlamat').value;
                
                simpanData();
                showToast('Data murid diupdate!');
                tutupModal('modalEdit');
                tampilkanMurid();
                tampilkanAbsensi();
            }
        });

        function hapusMurid(id) {
            if (confirm('Yakin hapus murid ini?')) {
                muridList = muridList.filter(m => m.id !== id);
                absensiList = absensiList.filter(a => a.muridId !== id);
                simpanData();
                showToast('Murid dihapus!', 'error');
                tampilkanMurid();
                updateStats();
            }
        }

        function tutupModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        // ==================== ABSENSI FUNCTIONS ====================
        function loadAbsensiSesi() {
            const sesiId = document.getElementById('sesiAbsensi').value;
            const sesiInfo = document.getElementById('sesiInfo');
            
            if (!sesiId) {
                sesiInfo.style.display = 'none';
                document.getElementById('emptyAbsensi').style.display = 'block';
                document.getElementById('tabelAbsensi').innerHTML = '';
                return;
            }
            
            const jadwal = jadwalList.find(j => j.id === sesiId);
            if (jadwal) {
                sesiInfo.style.display = 'flex';
                document.getElementById('sesiNamaInfo').textContent = jadwal.nama;
                document.getElementById('sesiWaktuInfo').textContent = `${jadwal.jamMulai} - ${jadwal.jamSelesai} | ${jadwal.kelas}`;
            }
            
            tampilkanAbsensi();
        }

        function tampilkanAbsensi() {
            const sesiId = document.getElementById('sesiAbsensi').value;
            if (!sesiId) return;
            
            const jadwal = jadwalList.find(j => j.id === sesiId);
            const filterKelas = document.getElementById('filterKelasAbsensi').value;
            const tanggal = getTanggalHariIni();
            
            let filtered = muridList.filter(m => {
                const matchKelas = !filterKelas || m.kelas === filterKelas;
                const matchJadwal = jadwal.kelas === 'Semua' || m.kelas === jadwal.kelas;
                return matchKelas && matchJadwal;
            });
            
            const tbody = document.getElementById('tabelAbsensi');
            const empty = document.getElementById('emptyAbsensi');
            
            document.getElementById('totalAbsensi').textContent = `${filtered.length} Murid`;
            
            if (filtered.length === 0) {
                tbody.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            
            tbody.innerHTML = filtered.map((m, i) => {
                const absen = absensiList.find(a => 
                    a.muridId === m.id && 
                    a.tanggal === tanggal && 
                    a.sesiId === sesiId
                );
                
                const status = absen ? absen.status : 'belum';
                const jamAbsen = absen ? absen.waktu : '-';
                
                let badgeClass = 'badge-belum';
                let badgeText = 'Belum Absen';
                
                if (status === 'hadir') { badgeClass = 'badge-hadir'; badgeText = 'Hadir'; }
                else if (status === 'izin') { badgeClass = 'badge-izin'; badgeText = 'Izin'; }
                else if (status === 'alpha') { badgeClass = 'badge-alpha'; badgeText = 'Alpha'; }
                
                return `
                    <tr>
                        <td>${i + 1}</td>
                        <td>
                            <div class="student-info">
                                <div class="student-avatar">${getInitials(m.nama)}</div>
                                <div class="student-details">
                                    <h4>${m.nama}</h4>
                                </div>
                            </div>
                        </td>
                        <td><span class="badge badge-kelas">${m.kelas}</span></td>
                        <td><span class="badge ${badgeClass}"><i class="fas fa-circle" style="font-size: 6px;"></i> ${badgeText}</span></td>
                        <td>${jamAbsen}</td>
                        <td>
                            <div class="action-btns">
                                <button class="btn btn-success btn-sm" onclick="absen('${m.id}', 'hadir')" ${status === 'hadir' ? 'disabled style="opacity:0.5"' : ''}>
                                    <i class="fas fa-check"></i>
                                </button>
                                <button class="btn btn-warning btn-sm" onclick="absen('${m.id}', 'izin')" ${status === 'izin' ? 'disabled style="opacity:0.5"' : ''}>
                                    <i class="fas fa-envelope"></i>
                                </button>
                                <button class="btn btn-danger btn-sm" onclick="absen('${m.id}', 'alpha')" ${status === 'alpha' ? 'disabled style="opacity:0.5"' : ''}>
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function absen(muridId, status) {
            const sesiId = document.getElementById('sesiAbsensi').value;
            if (!sesiId) {
                showToast('Pilih sesi terlebih dahulu!', 'warning');
                return;
            }
            
            const tanggal = getTanggalHariIni();
            const waktu = getWaktuSekarang();
            const murid = muridList.find(m => m.id === muridId);
            const jadwal = jadwalList.find(j => j.id === sesiId);
            
            // Remove existing
            absensiList = absensiList.filter(a => 
                !(a.muridId === muridId && a.tanggal === tanggal && a.sesiId === sesiId)
            );
            
            // Add new
            absensiList.push({
                id: generateId(),
                muridId: muridId,
                sesiId: sesiId,
                namaMurid: murid.nama,
                namaSesi: jadwal.nama,
                kelas: murid.kelas,
                tanggal: tanggal,
                waktu: waktu,
                status: status,
                jamSesi: `${jadwal.jamMulai} - ${jadwal.jamSelesai}`
            });
            
            simpanData();
            showToast(`${murid.nama} - ${status.toUpperCase()}`);
            tampilkanAbsensi();
            updateStats();
            tampilkanRiwayat();
        }

        function absensiSemuaHadir() {
            const sesiId = document.getElementById('sesiAbsensi').value;
            if (!sesiId) {
                showToast('Pilih sesi terlebih dahulu!', 'warning');
                return;
            }
            
            const jadwal = jadwalList.find(j => j.id === sesiId);
            const filterKelas = document.getElementById('filterKelasAbsensi').value;
            const tanggal = getTanggalHariIni();
            const waktu = getWaktuSekarang();
            
            let filtered = muridList.filter(m => {
                const matchKelas = !filterKelas || m.kelas === filterKelas;
                const matchJadwal = jadwal.kelas === 'Semua' || m.kelas === jadwal.kelas;
                return matchKelas && matchJadwal;
            });
            
            filtered.forEach(m => {
                absensiList = absensiList.filter(a => 
                    !(a.muridId === m.id && a.tanggal === tanggal && a.sesiId === sesiId)
                );
                
                absensiList.push({
                    id: generateId(),
                    muridId: m.id,
                    sesiId: sesiId,
                    namaMurid: m.nama,
                    namaSesi: jadwal.nama,
                    kelas: m.kelas,
                    tanggal: tanggal,
                    waktu: waktu,
                    status: 'hadir',
                    jamSesi: `${jadwal.jamMulai} - ${jadwal.jamSelesai}`
                });
            });
            
            simpanData();
            showToast('Semua murid sudah HADIR!');
            tampilkanAbsensi();
            updateStats();
            tampilkanRiwayat();
        }

        // ==================== RIWAYAT FUNCTIONS ====================
        function tampilkanRiwayat() {
            const tbody = document.getElementById('tabelRiwayat');
            const empty = document.getElementById('emptyRiwayat');
            
            if (absensiList.length === 0) {
                tbody.innerHTML = '';
                empty.style.display = 'block';
                return;
            }
            
            empty.style.display = 'none';
            const sorted = [...absensiList].sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal));
            
            tbody.innerHTML = sorted.slice(0, 100).map((a, i) => {
                let badgeClass = 'badge-belum';
                if (a.status === 'hadir') badgeClass = 'badge-hadir';
                else if (a.status === 'izin') badgeClass = 'badge-izin';
                else if (a.status === 'alpha') badgeClass = 'badge-alpha';
                
                return `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${formatTanggalShort(a.tanggal)}</td>
                        <td>${a.namaSesi || '-'}<br><small style="color:rgba(255,255,255,0.5)">${a.jamSesi || '-'}</small></td>
                        <td>
                            <div class="student-info">
                                <div class="student-avatar" style="width:35px;height:35px;font-size:0.8rem;">${getInitials(a.namaMurid)}</div>
                                <span>${a.namaMurid}</span>
                            </div>
                        </td>
                        <td><span class="badge badge-kelas">${a.kelas}</span></td>
                        <td><span class="badge ${badgeClass}">${a.status.toUpperCase()}</span></td>
                        <td>${a.waktu}</td>
                    </tr>
                `;
            }).join('');
        }

        function filterRiwayat() {
            const dari = document.getElementById('filterDari').value;
            const sampai = document.getElementById('filterSampai').value;
            const kelas = document.getElementById('filterKelasRiwayat').value;
            const status = document.getElementById('filterStatus').value;
            
            const tbody = document.getElementById('tabelRiwayat');
            
            let filtered = absensiList.filter(a => {
                return (!dari || a.tanggal >= dari) &&
                       (!sampai || a.tanggal <= sampai) &&
                       (!kelas || a.kelas === kelas) &&
                       (!status || a.status === status);
            });
            
            filtered.sort((a, b) => new Date(b.tanggal) - new Date(a.tanggal));
            
            tbody.innerHTML = filtered.map((a, i) => {
                let badgeClass = a.status === 'hadir' ? 'badge-hadir' : a.status === 'izin' ? 'badge-izin' : 'badge-alpha';
                return `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${formatTanggalShort(a.tanggal)}</td>
                        <td>${a.namaSesi || '-'}<br><small style="color:rgba(255,255,255,0.5)">${a.jamSesi || '-'}</small></td>
                        <td>
                            <div class="student-info">
                                <div class="student-avatar" style="width:35px;height:35px;font-size:0.8rem;">${getInitials(a.namaMurid)}</div>
                                <span>${a.namaMurid}</span>
                            </div>
                        </td>
                        <td><span class="badge badge-kelas">${a.kelas}</span></td>
                        <td><span class="badge ${badgeClass}">${a.status.toUpperCase()}</span></td>
                        <td>${a.waktu}</td>
                    </tr>
                `;
            }).join('');
            
            showToast(`Ditemukan ${filtered.length} data`);
        }

        // ==================== LAPORAN ====================
        function tampilkanLaporan() {
            const bulan = document.getElementById('filterBulan').value;
            const kelas = document.getElementById('filterKelasLaporan').value;
            const tbody = document.getElementById('tabelLaporan');
            
            let filtered = muridList.filter(m => !kelas || m.kelas === kelas);
            
            tbody.innerHTML = filtered.map((m, i) => {
                let absensiMurid = absensiList.filter(a => {
                    const matchMurid = a.muridId === m.id;
                    const matchBulan = !bulan || a.tanggal.startsWith(bulan);
                    return matchMurid && matchBulan;
                });
                
                const hadir = absensiMurid.filter(a => a.status === 'hadir').length;
                const izin = absensiMurid.filter(a => a.status === 'izin').length;
                const alpha = absensiMurid.filter(a => a.status === 'alpha').length;
                const total = hadir + izin + alpha;
                const persen = total > 0 ? Math.round((hadir / total) * 100) : 0;
                
                return `
                    <tr>
                        <td>${i + 1}</td>
                        <td>
                            <div class="student-info">
                                <div class="student-avatar">${getInitials(m.nama)}</div>
                                <span>${m.nama}</span>
                            </div>
                        </td>
                        <td><span class="badge badge-kelas">${m.kelas}</span></td>
                        <td><span class="badge badge-hadir">${hadir}</span></td>
                        <td><span class="badge badge-izin">${izin}</span></td>
                        <td><span class="badge badge-alpha">${alpha}</span></td>
                        <td>
                            <strong>${persen}%</strong>
                            <div class="progress-bar">
                                <div class="progress" style="width: ${persen}%"></div>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ==================== EXPORT ====================
        function exportRiwayat() {
            let csv = 'No,Tanggal,Sesi,Jam Sesi,Nama Murid,Kelas,Status,Jam Absen\n';
            absensiList.forEach((a, i) => {
                csv += `${i+1},"${formatTanggalShort(a.tanggal)}","${a.namaSesi}","${a.jamSesi}","${a.namaMurid}","${a.kelas}","${a.status}","${a.waktu}"\n`;
            });
            downloadCSV(csv, 'riwayat_absensi.csv');
        }

        function exportLaporan() {
            const bulan = document.getElementById('filterBulan').value;
            let csv = 'No,Nama Murid,Kelas,Hadir,Izin,Alpha,Persentase\n';
            
            muridList.forEach((m, i) => {
                let absensiMurid = absensiList.filter(a => {
                    return a.muridId === m.id && (!bulan || a.tanggal.startsWith(bulan));
                });
                
                const hadir = absensiMurid.filter(a => a.status === 'hadir').length;
                const izin = absensiMurid.filter(a => a.status === 'izin').length;
                const alpha = absensiMurid.filter(a => a.status === 'alpha').length;
                const total = hadir + izin + alpha;
                const persen = total > 0 ? Math.round((hadir / total) * 100) : 0;
                
                csv += `${i+1},"${m.nama}","${m.kelas}",${hadir},${izin},${alpha},${persen}%\n`;
            });
            
            downloadCSV(csv, 'laporan_absensi.csv');
        }

        function exportData() {
            const data = { muridList, jadwalList, absensiList };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'backup_lesku.json';
            link.click();
            showToast('Data berhasil di-export!');
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
            showToast('File berhasil didownload!');
        }

        // ==================== STATS & FILTERS ====================
        function updateStats() {
            const tanggal = getTanggalHariIni();
            const today = absensiList.filter(a => a.tanggal === tanggal);
            
            document.getElementById('statTotalMurid').textContent = muridList.length;
            document.getElementById('statHadir').textContent = today.filter(a => a.status === 'hadir').length;
            document.getElementById('statIzin').textContent = today.filter(a => a.status === 'izin').length;
            document.getElementById('statAlpha').textContent = today.filter(a => a.status === 'alpha').length;
        }

        function updateFilterKelas() {
            const kelasList = [...new Set(muridList.map(m => m.kelas))].sort();
            const filters = ['filterKelasMurid', 'filterKelasAbsensi', 'filterKelasRiwayat', 'filterKelasLaporan'];
            
            filters.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    const val = el.value;
                    el.innerHTML = '<option value="">Semua Kelas</option>' + 
                        kelasList.map(k => `<option value="${k}">${k}</option>`).join('');
                    el.value = val;
                }
            });
        }

        // ==================== INIT ====================
        function init() {
            document.getElementById('absensiDate').textContent = formatTanggal(new Date());
            
            const now = new Date();
            document.getElementById('filterBulan').value = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
            
            updateFilterKelas();
            tampilkanMurid();
            tampilkanJadwal();
            tampilkanJadwalHariIni();
            tampilkanRiwayat();
            tampilkanLaporan();
            updateStats();
            updateSesiDropdown();
        }

        // Close modal on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        init();
    </script>
</body>
</html>
