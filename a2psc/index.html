Tentu, ini perbaikan kodenya. Masalah utama biasanya ada pada pengaturan ketinggian (`height`) di panel kanan yang membuat tabel tidak memunculkan *scrollbar* atau justru memanjang ke bawah tanpa batas.

Berikut adalah perbaikannya:

1.  **Perbaikan Scroll Tabel:** Saya mengubah container tabel agar memiliki ketinggian yang dinamis (`calc(100vh - ...)`). Ini memaksa tabel untuk *scroll* di dalam areanya sendiri (sehingga Header Tabel tetap *sticky* di atas), sementara halaman utama tidak perlu di-scroll terlalu jauh.
2.  **Perbaikan Scroll Sidebar:** Form input di kiri juga diberi antisipasi agar jika layarnya pendek, form tersebut bisa di-scroll terpisah.
3.  **Tampilan Notes:** Kolom notes sudah diatur agar rapi (tidak terlalu lebar, tidak terlalu sempit).

Silakan copy-paste **Full Code** di bawah ini:

```html
<!DOCTYPE html>
<html lang="id" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Raj Sales Intelligence</title>
  <meta name="theme-color" content="#0B0F19">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Plus Jakarta Sans"', 'sans-serif'],
            mono: ['"JetBrains Mono"', 'monospace'],
          },
          colors: {
            primary: '#F59E0B', 
          },
          animation: {
            'fade-in': 'fadeIn 0.4s ease-out forwards',
            'slide-up': 'slideUp 0.4s ease-out forwards',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideUp: {
              '0%': { opacity: '0', transform: 'translateY(20px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    /* Scrollbar Kustom yang Elegan */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; border: 2px solid #0B0F19; }
    ::-webkit-scrollbar-thumb:hover { background: #475569; }

    body {
      background-color: #050505;
      background-image: 
        radial-gradient(circle at 15% 50%, rgba(99, 102, 241, 0.08), transparent 25%), 
        radial-gradient(circle at 85% 30%, rgba(245, 158, 11, 0.05), transparent 25%);
      min-height: 100vh;
      overflow-x: hidden; /* Mencegah scroll horizontal halaman */
    }

    /* Efek Kaca (Glassmorphism) */
    .glass {
      background: rgba(20, 22, 27, 0.7);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
    }

    /* Input Modern */
    .input-modern {
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.2s ease;
    }
    .input-modern:focus {
      background: rgba(0, 0, 0, 0.6);
      border-color: #F59E0B;
      box-shadow: 0 0 0 1px rgba(245, 158, 11, 0.3);
      outline: none;
    }

    /* Hover Baris Tabel */
    .table-row-hover:hover {
      background: linear-gradient(90deg, rgba(245, 158, 11, 0.05) 0%, rgba(255,255,255,0.02) 100%);
    }
    
    /* Membatasi teks Notes */
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
</head>
<body class="text-slate-400 font-sans antialiased selection:bg-primary selection:text-black pb-10">

  <!-- Toast Notification -->
  <div id="toast" class="fixed bottom-8 right-8 z-[100] hidden transform transition-all duration-500 translate-y-10 opacity-0">
    <div class="glass rounded-xl p-4 flex items-center gap-4 shadow-2xl border-l-4 border-emerald-500 bg-[#0F1115]">
      <div class="bg-emerald-500/10 p-2 rounded-lg text-emerald-400 text-xl">‚úÖ</div>
      <div>
        <h4 id="toastTitle" class="text-sm font-bold text-white">Success</h4>
        <p id="toastMessage" class="text-xs text-slate-400 mt-0.5">Action done.</p>
      </div>
    </div>
  </div>

  <!-- Navbar -->
  <nav class="fixed w-full top-0 z-40 border-b border-white/5 bg-[#050505]/90 backdrop-blur-xl">
    <div class="max-w-[1800px] mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-lg bg-gradient-to-br from-amber-400 to-orange-600 flex items-center justify-center shadow-lg shadow-orange-500/10 text-black font-bold text-lg">M</div>
          <h1 class="text-white font-bold text-base tracking-tight">Mi Raj <span class="text-amber-500">Tracker</span></h1>
        </div>

        <div class="relative group">
          <button id="menuBtn" class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 hover:bg-white/10 border border-white/5 text-xs font-medium text-white transition-all">
            <span>Menu</span>
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </button>
          <div id="menu" class="absolute right-0 mt-2 w-56 glass rounded-xl shadow-2xl py-2 hidden transform origin-top-right transition-all z-50 bg-[#0F1115]">
            <button id="importBtn" class="w-full text-left px-4 py-2.5 text-xs text-slate-300 hover:bg-white/5 hover:text-white flex items-center gap-3">
              <span class="text-blue-400">üì•</span> Import CSV
            </button>
            <button id="exportAllBtn" class="w-full text-left px-4 py-2.5 text-xs text-slate-300 hover:bg-white/5 hover:text-white flex items-center gap-3">
              <span class="text-emerald-400">üì§</span> Export All
            </button>
            <button id="targetBtn" class="w-full text-left px-4 py-2.5 text-xs text-slate-300 hover:bg-white/5 hover:text-white flex items-center gap-3">
              <span class="text-amber-400">üéØ</span> Set Target
            </button>
            <button id="chartBtn" class="w-full text-left px-4 py-2.5 text-xs text-slate-300 hover:bg-white/5 hover:text-white flex items-center gap-3">
              <span class="text-purple-400">üìä</span> Analytics
            </button>
            <div class="h-px bg-white/5 my-1"></div>
            <button id="resetBtn" class="w-full text-left px-4 py-2.5 text-xs text-rose-500 hover:bg-rose-500/10 flex items-center gap-3">
              <span>üí•</span> Reset Data
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Layout -->
  <main class="max-w-[1800px] mx-auto px-4 sm:px-6 lg:px-8 py-8 mt-16">
    
    <!-- 1. Stats Overview -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8 animate-slide-up" style="animation-delay: 0.1s;">
      <!-- Card Revenue -->
      <div class="glass rounded-2xl p-5 relative overflow-hidden group hover:border-emerald-500/30 transition-all">
        <div class="absolute top-0 right-0 w-32 h-32 bg-emerald-500/10 rounded-full blur-3xl -mr-10 -mt-10"></div>
        <p class="text-[10px] font-bold uppercase tracking-widest text-emerald-500 mb-1">Net Revenue</p>
        <h3 id="statRevenue" class="text-3xl font-bold text-white tracking-tight">Rp 0</h3>
        <div id="statRevChange" class="inline-block mt-2 text-[10px] px-2 py-0.5 rounded bg-white/5 text-slate-400">vs prev month</div>
      </div>

      <!-- Card Conversion -->
      <div class="glass rounded-2xl p-5 relative overflow-hidden group hover:border-blue-500/30 transition-all">
        <div class="absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-3xl -mr-10 -mt-10"></div>
        <div class="flex justify-between mb-1">
          <p class="text-[10px] font-bold uppercase tracking-widest text-blue-500">Conversion</p>
          <p class="text-xs text-slate-400"><span id="statTcTotal" class="text-white font-bold">0</span> TCs</p>
        </div>
        <h3 id="statConversion" class="text-3xl font-bold text-white">0%</h3>
        <div class="flex gap-3 mt-2 text-xs">
          <span class="text-slate-500">Sales: <span id="statSales" class="text-blue-400 font-bold">0</span></span>
          <span class="text-slate-500">Pending: <span id="statPending" class="text-amber-400 font-bold">0</span></span>
        </div>
      </div>

      <!-- Card Bonus -->
      <div class="glass rounded-2xl p-5 relative overflow-hidden group hover:border-pink-500/30 transition-all">
        <div class="absolute top-0 right-0 w-32 h-32 bg-pink-500/10 rounded-full blur-3xl -mr-10 -mt-10"></div>
        <div class="flex justify-between items-center mb-1">
          <p class="text-[10px] font-bold uppercase tracking-widest text-pink-500">Est. Bonus</p>
          <span id="bonusLevel" class="text-[10px] font-bold bg-white/10 px-2 py-0.5 rounded text-white">Lvl 1</span>
        </div>
        <h3 id="statBonus" class="text-2xl font-bold text-white">Rp 0</h3>
        <div class="w-full bg-slate-800 h-1.5 rounded-full mt-3 overflow-hidden">
          <div id="bonusBar" class="h-full bg-gradient-to-r from-purple-500 to-pink-500 w-0 transition-all duration-1000"></div>
        </div>
        <p class="text-[10px] text-slate-500 mt-1">Rate: <span id="bonusPercent" class="text-white">0%</span> ‚Ä¢ TC Sal: <span id="statTcSalary" class="text-white">Rp 0</span></p>
      </div>

      <!-- Card Target -->
      <div id="targetSection" class="glass rounded-2xl p-5 relative overflow-hidden flex flex-col justify-between hidden hover:border-amber-500/30 transition-all">
        <div class="flex justify-between items-end mb-1">
           <p class="text-[10px] font-bold uppercase tracking-widest text-amber-500">Target</p>
           <p id="targetPercent" class="text-xl font-bold text-white">0%</p>
        </div>
        <div class="flex items-baseline gap-1">
          <h3 id="targetCurrent" class="text-lg font-bold text-slate-300">Rp 0</h3>
          <span class="text-xs text-slate-600">/ <span id="targetDesc">Rp 0</span></span>
        </div>
        <div class="w-full bg-slate-800 h-2 rounded-full mt-2 overflow-hidden relative">
           <div id="targetProgress" class="h-full bg-amber-500 rounded-full relative transition-all duration-1000" style="width: 0%">
             <div class="absolute inset-0 bg-white/30 animate-[shimmer_2s_infinite]"></div>
           </div>
        </div>
        <p class="text-[10px] text-slate-500 mt-1 text-right">Sisa: <span id="targetRemaining" class="text-white">Rp 0</span></p>
      </div>
    </div>

    <!-- 2. Workspace Split -->
    <div class="grid lg:grid-cols-12 gap-6 animate-slide-up" style="animation-delay: 0.2s;">
      
      <!-- LEFT PANEL (Sticky & Scrollable if needed) -->
      <div class="lg:col-span-3 flex flex-col gap-5">
        <!-- Agar sticky berfungsi dengan baik -->
        <div class="sticky top-24 space-y-5 max-h-[calc(100vh-120px)] overflow-y-auto pr-1 custom-scrollbar">
          
          <!-- Entry Form -->
          <div class="glass rounded-2xl p-5 border-t-4 border-t-amber-500">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-bold text-white text-sm flex items-center gap-2">
                <span id="formTitle">New Record</span>
              </h3>
              <button id="clearFormBtn" class="text-[10px] text-slate-500 hover:text-white uppercase font-bold">Reset</button>
            </div>

            <form id="entryForm" class="space-y-3">
              <input type="hidden" id="editingId">
              
              <div class="grid grid-cols-2 gap-2">
                 <div class="space-y-1">
                   <label class="text-[10px] uppercase text-slate-500 font-bold">Date</label>
                   <input id="date" type="date" required class="w-full input-modern rounded-lg px-3 py-2 text-xs text-white">
                 </div>
                 <div class="space-y-1">
                   <label class="text-[10px] uppercase text-slate-500 font-bold">Time</label>
                   <input id="time" type="time" class="w-full input-modern rounded-lg px-3 py-2 text-xs text-white">
                 </div>
              </div>

              <div class="space-y-1">
                 <label class="text-[10px] uppercase text-slate-500 font-bold">Student Name</label>
                 <input id="childName" type="text" placeholder="Name..." class="w-full input-modern rounded-lg px-3 py-2 text-sm text-white placeholder-slate-600">
              </div>

               <div class="space-y-1">
                 <label class="text-[10px] uppercase text-slate-500 font-bold">CRM Link</label>
                 <input id="crm" type="url" placeholder="https://..." class="w-full input-modern rounded-lg px-3 py-2 text-xs text-blue-400 placeholder-slate-700">
              </div>

              <div class="grid grid-cols-2 gap-2">
                 <div class="space-y-1">
                   <label class="text-[10px] uppercase text-slate-500 font-bold">Course</label>
                   <select id="course" required class="w-full input-modern rounded-lg px-2 py-2 text-xs text-white cursor-pointer">
                     <option value="">Select...</option>
                      <option value="Coding Knight">Coding Knight</option>
                      <option value="Digital Literasi">Digital Literasi</option>
                      <option value="Visual Programming">Visual Programming</option>
                      <option value="Graphic Design Junior">GD Junior</option>
                      <option value="Graphic Design Senior">GD Senior</option>
                      <option value="Game Design">Game Design</option>
                      <option value="Python Start">Python Start</option>
                      <option value="Python Pro">Python Pro</option>
                      <option value="Math Explorers">Math Exp.</option>
                      <option value="Math Masters">Math Masters</option>
                      <option value="Course AI">Course AI</option>
                      <option value="Math Tutoring">Math Tutor</option>
                   </select>
                 </div>
                 <div class="space-y-1">
                   <label class="text-[10px] uppercase text-slate-500 font-bold">Status</label>
                   <select id="buyOrNot" required class="w-full input-modern rounded-lg px-2 py-2 text-xs text-white cursor-pointer">
                     <option value="">Select...</option>
                     <option value="Buy">‚úÖ Buy</option>
                     <option value="Not">‚ùå Not Buy</option>
                     <option value="Pending">‚è≥ Pending</option>
                   </select>
                 </div>
              </div>

              <div class="grid grid-cols-2 gap-2">
                <div class="space-y-1">
                   <label class="text-[10px] uppercase text-slate-500 font-bold">Revenue</label>
                   <input id="revenue" type="number" placeholder="0" class="w-full input-modern rounded-lg px-3 py-2 text-xs text-emerald-400 font-mono placeholder-slate-700">
                 </div>
                 <div class="space-y-1">
                   <label class="text-[10px] uppercase text-slate-500 font-bold">Layer</label>
                   <select id="layer" class="w-full input-modern rounded-lg px-2 py-2 text-xs text-white cursor-pointer">
                     <option value="">-</option>
                     <option value="TCP">TCP</option>
                     <option value="ND">ND</option>
                     <option value="PP">PP</option>
                     <option value="Other">Other</option>
                   </select>
                 </div>
              </div>

              <div class="space-y-1">
                 <label class="text-[10px] uppercase text-slate-500 font-bold">Notes</label>
                 <textarea id="note" rows="3" placeholder="Details..." class="w-full input-modern rounded-lg px-3 py-2 text-xs text-white placeholder-slate-600 resize-none"></textarea>
              </div>

              <div class="pt-2 flex gap-2">
                <button type="submit" class="flex-1 bg-amber-500 hover:bg-amber-400 text-black font-bold py-2.5 rounded-lg shadow-lg shadow-amber-500/20 transition-all transform hover:-translate-y-0.5 text-sm">
                  Save Record
                </button>
                <button type="button" id="duplicateBtn" class="hidden px-3 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors" title="Duplicate">üìã</button>
              </div>
            </form>
          </div>

          <!-- Filters Mini -->
          <div class="glass rounded-2xl p-5">
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-bold text-slate-400 text-xs uppercase tracking-wider">Filters</h3>
              <button id="refreshBtn" class="text-amber-500 hover:text-amber-400 text-xs font-bold">Refresh</button>
            </div>
            <div class="space-y-2.5">
              <input id="searchInput" type="text" placeholder="Search name..." class="w-full input-modern rounded-lg px-3 py-2 text-xs text-white">
              <div class="grid grid-cols-2 gap-2">
                <select id="monthSelector" class="input-modern rounded-lg px-2 py-2 text-xs text-slate-300 cursor-pointer"></select>
                <select id="periodFilter" class="input-modern rounded-lg px-2 py-2 text-xs text-slate-300 cursor-pointer">
                  <option value="">All Time</option>
                  <option value="P1">P1 (1-15)</option>
                  <option value="P2">P2 (16-31)</option>
                </select>
              </div>
              <select id="courseFilter" class="w-full input-modern rounded-lg px-2 py-2 text-xs text-slate-300 cursor-pointer">
                <option value="">All Courses</option>
              </select>
              <div class="flex justify-between text-[10px] text-slate-500 pt-1">
                <span id="recordCount">0 records</span>
                <button id="exportCurrentBtn" class="hover:text-white transition-colors">Exp. CSV</button>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- RIGHT PANEL (Table) - FIX SCROLL -->
      <!-- Perubahan: lg:h-[calc(100vh-140px)] membuat tabel fit di layar desktop dan scroll internal -->
      <div class="lg:col-span-9 flex flex-col h-[600px] lg:h-[calc(100vh-140px)]">
        <div class="glass rounded-2xl flex-1 flex flex-col overflow-hidden relative">
          
          <!-- Table Header Actions -->
          <div class="p-4 border-b border-white/5 flex justify-between items-center bg-[#0F1115]/50">
            <div class="flex items-center gap-3">
               <h2 class="text-white font-bold text-sm">Data Log</h2>
               <div class="h-4 w-px bg-white/10"></div>
               <span id="selectedMonth" class="text-xs text-amber-500 font-mono"></span>
            </div>
            <button id="bulkDeleteBtn" class="hidden items-center gap-2 px-3 py-1 bg-rose-500/10 text-rose-500 border border-rose-500/20 hover:bg-rose-500/20 rounded text-xs font-bold transition-all">
              Delete (<span id="selectedCount">0</span>)
            </button>
          </div>

          <!-- Table Container dengan Scroll -->
          <div class="overflow-auto flex-1 w-full custom-scrollbar">
            <!-- Empty State -->
            <div id="emptyState" class="hidden absolute inset-0 flex flex-col items-center justify-center text-center p-8 z-10 bg-[#0B0F19]/80 backdrop-blur-sm">
              <div class="w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center mb-4">
                <span class="text-3xl">üì≠</span>
              </div>
              <h3 class="text-slate-300 font-bold mb-1">No Records Found</h3>
              <p class="text-slate-500 text-xs">Add data via the form on the left.</p>
            </div>

            <table class="w-full text-left border-collapse">
              <thead class="bg-[#0F1115] text-[10px] text-slate-500 uppercase font-bold tracking-wider sticky top-0 z-20 shadow-lg border-b border-white/5">
                <tr>
                  <th class="p-4 w-10 bg-[#0F1115]"><input type="checkbox" id="selectAll" class="rounded border-slate-700 bg-transparent text-amber-500 focus:ring-0 cursor-pointer"></th>
                  <th class="p-4 cursor-pointer hover:text-white transition-colors bg-[#0F1115]" data-sort="date">Date ‚Üï</th>
                  <th class="p-4 bg-[#0F1115]">Student / CRM</th>
                  <th class="p-4 bg-[#0F1115]">Course</th>
                  <th class="p-4 cursor-pointer hover:text-white transition-colors bg-[#0F1115]" data-sort="buyOrNot">Status ‚Üï</th>
                  <th class="p-4 cursor-pointer hover:text-white transition-colors bg-[#0F1115]" data-sort="revenue">Revenue ‚Üï</th>
                  <!-- NOTES HEADER -->
                  <th class="p-4 bg-[#0F1115] min-w-[180px]">Notes</th> 
                  <th class="p-4 text-right bg-[#0F1115]">Action</th>
                </tr>
              </thead>
              <tbody id="tbody" class="text-sm text-slate-300 divide-y divide-white/5">
                <!-- Rows injected here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- MODALS -->
  <div id="modalBackdrop" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden transition-opacity"></div>

  <!-- Chart Modal -->
  <div id="chartModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
    <div class="w-full max-w-4xl bg-[#0F1115] border border-white/10 rounded-2xl shadow-2xl flex flex-col max-h-[90vh] animate-slide-up">
      <div class="p-5 border-b border-white/5 flex justify-between items-center bg-[#15181E]">
        <h3 class="text-white font-bold">Analytics</h3>
        <button id="closeChartBtn" class="text-slate-500 hover:text-white">‚úï</button>
      </div>
      <div class="p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6">
         <div class="glass p-5 rounded-xl border border-white/5">
           <h4 class="text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest">Status</h4>
           <div id="statusChart" class="h-40 flex items-end gap-2 px-2"></div>
         </div>
         <div class="glass p-5 rounded-xl border border-white/5 md:col-span-2">
           <h4 class="text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest">Courses</h4>
           <div id="courseBreakdown" class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-3"></div>
         </div>
      </div>
    </div>
  </div>

  <!-- Target Modal -->
  <div id="targetModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
    <div class="w-full max-w-md bg-[#0F1115] border border-amber-500/30 rounded-2xl shadow-2xl p-6 animate-slide-up">
       <h3 class="text-lg font-bold text-white mb-1">üéØ Monthly Target</h3>
       <div class="relative mb-6 mt-4">
         <span class="absolute left-3 top-3 text-slate-500 font-mono">Rp</span>
         <input id="targetInput" type="number" class="w-full bg-black/50 border border-white/10 rounded-xl p-3 pl-10 text-xl font-bold text-white focus:border-amber-500 outline-none">
       </div>
       <div class="flex justify-end gap-3">
         <button id="cancelTargetBtn" class="px-4 py-2 text-slate-400 hover:text-white text-sm">Cancel</button>
         <button id="saveTargetBtn" class="px-4 py-2 bg-amber-500 hover:bg-amber-400 text-black font-bold rounded-lg text-sm">Save</button>
       </div>
    </div>
  </div>

  <!-- Password Modal -->
  <div id="pwModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
    <div class="w-full max-w-sm bg-[#0F1115] border border-rose-500/30 rounded-2xl shadow-2xl p-6 animate-slide-up">
       <h3 class="text-lg font-bold text-white text-rose-500 mb-2">‚ö†Ô∏è Factory Reset</h3>
       <p class="text-xs text-slate-400 mb-4">Delete ALL data?</p>
       <input id="pwInput" type="password" class="w-full bg-black/50 border border-white/10 rounded-lg p-3 text-white focus:border-rose-500 outline-none mb-6" placeholder="Password...">
       <div class="flex justify-end gap-3">
         <button id="cancelPwBtn" class="px-4 py-2 text-slate-400 hover:text-white text-sm">Cancel</button>
         <button id="confirmPwBtn" class="px-4 py-2 bg-rose-600 hover:bg-rose-500 text-white font-bold rounded-lg text-sm">RESET</button>
       </div>
    </div>
  </div>

  <!-- Import Modal -->
  <div id="importModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
    <div class="w-full max-w-md bg-[#0F1115] border border-white/10 rounded-2xl shadow-2xl p-6 animate-slide-up">
       <h3 class="text-lg font-bold text-white mb-2">üì• Import CSV</h3>
       <div class="border-2 border-dashed border-white/10 rounded-xl p-8 text-center hover:border-blue-500/50 hover:bg-blue-500/5 transition-all cursor-pointer relative">
         <input type="file" id="importFile" accept=".csv" class="absolute inset-0 opacity-0 cursor-pointer w-full h-full">
         <div class="text-3xl mb-2">üìÑ</div>
         <span class="text-sm text-blue-400 font-medium">Click to Upload</span>
       </div>
       <div class="flex justify-end gap-3 mt-6">
         <button id="cancelImportBtn" class="px-4 py-2 text-slate-400 hover:text-white text-sm">Cancel</button>
         <button id="confirmImportBtn" class="px-4 py-2 bg-white/10 hover:bg-white/20 text-white font-bold rounded-lg text-sm">Import</button>
       </div>
    </div>
  </div>

  <!-- LOGIC SCRIPT -->
  <script>
    const STORAGE_KEY = 'mrj_sales_v3';
    const TARGET_KEY = 'mrj_target_v3';
    const RESET_PASSWORD = 'reset'; 
    const DOLLAR_RATE = 16000;
    const SALES_COMMISSION_USD = 2.5;

    const COURSES = ['Coding Knight', 'Digital Literasi', 'Visual Programming', 'Graphic Design Junior', 'Graphic Design Senior', 'Game Design', 'Python Start', 'Python Pro', 'Math Explorers', 'Math Masters', 'Course AI', 'Math Tutoring'];

    function uid() { return 'id-' + Date.now() + Math.random().toString(36).slice(2,9); }
    function formatRp(num) { return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits: 0 }).format(Number(num)||0); }

    function showToast(title, msg = '', icon = '‚úÖ') {
      const t = document.getElementById('toast');
      document.getElementById('toastTitle').textContent = title;
      document.getElementById('toastMessage').textContent = msg;
      t.classList.remove('hidden');
      setTimeout(() => t.classList.remove('translate-y-10', 'opacity-0'), 10);
      setTimeout(() => { t.classList.add('translate-y-10', 'opacity-0'); setTimeout(() => t.classList.add('hidden'), 500); }, 3000);
    }

    function loadData() { try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; } catch { return []; } }
    function saveData(arr) { localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }
    function getTarget() { try { return JSON.parse(localStorage.getItem(TARGET_KEY)); } catch { return null; } }
    function saveTarget(m, v) { localStorage.setItem(TARGET_KEY, JSON.stringify({ month: m, val: v })); }

    function calcStats(data, month) {
      const filtered = data.filter(r => r.monthKey === month);
      let tc = filtered.length, sales = 0, rev = 0, pend = 0;
      
      filtered.forEach(r => {
        const s = (r.buyOrNot||'').toLowerCase();
        if(s.includes('buy')) { sales++; rev += Number(r.revenue)||0; }
        else if(s.includes('pending')) pend++;
      });

      const conv = tc ? (sales/tc*100) : 0;
      
      let bp = 0;
      if(rev<=16830000) bp = conv<30?4.5:(conv<40?5.0:(conv<50?6.0:7.0));
      else if(rev<=33660000) bp = conv<30?5.5:(conv<40?6.0:(conv<50?7.0:8.0));
      else if(rev<=50490000) bp = conv<30?7.0:(conv<40?8.0:(conv<50?9.0:10.5));
      else if(rev<=67320000) bp = conv<30?8.5:(conv<40?10.0:(conv<50?11.5:13.0));
      else bp = conv<30?10.5:(conv<40?12.0:(conv<50?13.5:15.0));

      let lvl = rev>67320000?'MAX':(rev>50490000?'Lvl 4':(rev>33660000?'Lvl 3':(rev>16830000?'Lvl 2':'Lvl 1')));
      const tcSal = tc * SALES_COMMISSION_USD * DOLLAR_RATE;
      
      const [y,m] = month.split('-');
      const pk = m==='01'?`${parseInt(y)-1}-12`:`${y}-${String(parseInt(m)-1).padStart(2,'0')}`;
      const pr = data.filter(r=>r.monthKey===pk && (r.buyOrNot||'').toLowerCase().includes('buy')).reduce((a,b)=>a+(Number(b.revenue)||0),0);

      return { tc, sales, pend, rev, conv, bonus: rev*(bp/100), bp, lvl, tcSal, pr };
    }

    const els = { tbody: document.getElementById('tbody'), date: document.getElementById('date'), month: document.getElementById('monthSelector'), search: document.getElementById('searchInput'), course: document.getElementById('courseFilter'), period: document.getElementById('periodFilter') };
    let selRows = new Set();
    let curSort = { col: 'date', dir: 'desc' };

    function init() {
      els.date.valueAsDate = new Date();
      const d = loadData();
      const m = new Set(d.map(r => r.monthKey));
      m.add(new Date().toISOString().slice(0,7));
      els.month.innerHTML = '';
      Array.from(m).sort().reverse().forEach(k => {
        const opt = document.createElement('option');
        const [y,mo] = k.split('-');
        opt.value = k; opt.textContent = new Date(y,mo-1).toLocaleString('id-ID',{month:'long',year:'numeric'});
        els.month.appendChild(opt);
      });
      COURSES.forEach(c => { const o = document.createElement('option'); o.value=c; o.textContent=c; els.course.appendChild(o); });
      render();
    }

    function render() {
      const d = loadData();
      const mVal = els.month.value, pVal = els.period.value, sVal = els.search.value.toLowerCase(), cVal = els.course.value;

      let f = d.filter(r => {
        if(r.monthKey !== mVal) return false;
        if(pVal && (pVal==='P1' ? parseInt(r.date.split('-')[2])>15 : parseInt(r.date.split('-')[2])<=15)) return false;
        if(cVal && r.course !== cVal) return false;
        if(sVal && !JSON.stringify(r).toLowerCase().includes(sVal)) return false;
        return true;
      });

      f.sort((a,b) => {
        let va=a[curSort.col], vb=b[curSort.col];
        if(curSort.col==='revenue') { va=Number(va)||0; vb=Number(vb)||0; }
        return curSort.dir==='asc'?(va>vb?1:-1):(va<vb?1:-1);
      });

      const st = calcStats(d, mVal);
      document.getElementById('statRevenue').textContent = formatRp(st.rev);
      document.getElementById('statConversion').textContent = st.conv.toFixed(1)+'%';
      document.getElementById('statTcTotal').textContent = st.tc;
      document.getElementById('statSales').textContent = st.sales;
      document.getElementById('statPending').textContent = st.pend;
      document.getElementById('statBonus').textContent = formatRp(st.bonus);
      document.getElementById('bonusLevel').textContent = st.lvl;
      document.getElementById('bonusPercent').textContent = st.bp.toFixed(1)+'%';
      document.getElementById('statTcSalary').textContent = formatRp(st.tcSal);
      document.getElementById('bonusBar').style.width = Math.min(st.conv*2,100)+'%';
      
      const diff = st.rev - st.pr;
      const de = document.getElementById('statRevChange');
      de.textContent = (diff>=0?`‚ñ≤ +`:`‚ñº `) + formatRp(Math.abs(diff)) + ' vs prev';
      de.className = `inline-block mt-2 text-[10px] px-2 py-0.5 rounded ${diff>=0?'bg-emerald-500/10 text-emerald-400':'bg-rose-500/10 text-rose-400'}`;

      const tg = getTarget();
      const ts = document.getElementById('targetSection');
      if(tg && tg.month === mVal) {
        ts.classList.remove('hidden');
        const tv = Number(tg.val);
        const pct = Math.min((st.rev/tv)*100,100);
        document.getElementById('targetDesc').textContent = formatRp(tv);
        document.getElementById('targetCurrent').textContent = formatRp(st.rev);
        document.getElementById('targetPercent').textContent = pct.toFixed(1)+'%';
        document.getElementById('targetProgress').style.width = pct+'%';
        document.getElementById('targetRemaining').textContent = formatRp(Math.max(tv-st.rev,0));
      } else ts.classList.add('hidden');

      els.tbody.innerHTML = '';
      document.getElementById('recordCount').textContent = f.length + ' records';
      document.getElementById('selectedMonth').textContent = els.month.options[els.month.selectedIndex]?.text;

      if(f.length === 0) document.getElementById('emptyState').classList.remove('hidden');
      else {
        document.getElementById('emptyState').classList.add('hidden');
        f.forEach(r => {
          const tr = document.createElement('tr');
          tr.className = "table-row-hover border-b border-white/5 group";
          let sb = r.buyOrNot==='Buy'?'<span class="bg-emerald-500/10 text-emerald-400 px-2 py-0.5 rounded font-bold border border-emerald-500/20 text-[10px]">‚úÖ BUY</span>':(r.buyOrNot==='Not'?'<span class="bg-rose-500/10 text-rose-400 px-2 py-0.5 rounded font-bold border border-rose-500/20 text-[10px]">‚ùå NOT</span>':'<span class="bg-amber-500/10 text-amber-400 px-2 py-0.5 rounded font-bold border border-amber-500/20 text-[10px]">‚è≥ WAIT</span>');

          tr.innerHTML = `
            <td class="p-4"><input type="checkbox" class="row-cb rounded bg-transparent border-slate-600 text-amber-500 focus:ring-0 cursor-pointer" data-id="${r.id}" ${selRows.has(r.id)?'checked':''}></td>
            <td class="p-4 whitespace-nowrap"><div class="font-mono text-xs text-white font-bold">${r.date}</div><div class="text-[10px] text-slate-500">${r.time||''}</div></td>
            <td class="p-4"><div class="font-medium text-white text-xs">${r.childName||'-'}</div>${r.crm?`<a href="${r.crm}" target="_blank" class="text-[10px] text-blue-400 hover:underline">Link ‚Üó</a>`:''}</td>
            <td class="p-4 text-xs text-slate-400">${r.course}</td>
            <td class="p-4">${sb}</td>
            <td class="p-4 font-mono text-xs font-bold ${r.buyOrNot==='Buy'?'text-emerald-400':'text-slate-600'}">${formatRp(r.revenue)}</td>
            <!-- NOTES ROW -->
            <td class="p-4 max-w-[200px]">
               ${r.note?`<div class="line-clamp-2 text-[11px] text-slate-400 hover:text-white cursor-help leading-tight" title="${r.note}">${r.note}</div>`:'<span class="text-slate-700 text-[10px]">-</span>'}
            </td>
            <td class="p-4 text-right"><div class="flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity"><button onclick="edit('${r.id}')" class="p-1.5 text-blue-400 hover:bg-blue-500/20 rounded">‚úèÔ∏è</button><button onclick="del('${r.id}')" class="p-1.5 text-rose-400 hover:bg-rose-500/20 rounded">üóëÔ∏è</button></div></td>
          `;
          els.tbody.appendChild(tr);
        });
      }
      document.querySelectorAll('.row-cb').forEach(cb => cb.addEventListener('change', e=>{ e.target.checked?selRows.add(e.target.dataset.id):selRows.delete(e.target.dataset.id); updateBulk(); }));
    }

    function updateBulk() { const b = document.getElementById('bulkDeleteBtn'); if(selRows.size>0){ b.style.display='flex'; document.getElementById('selectedCount').textContent=selRows.size;} else b.style.display='none'; }

    document.getElementById('entryForm').addEventListener('submit', e => {
      e.preventDefault();
      const id = document.getElementById('editingId').value || uid();
      const date = document.getElementById('date').value;
      const entry = {
        id, date, time: document.getElementById('time').value,
        childName: document.getElementById('childName').value, crm: document.getElementById('crm').value,
        course: document.getElementById('course').value, buyOrNot: document.getElementById('buyOrNot').value,
        revenue: document.getElementById('revenue').value, layer: document.getElementById('layer').value,
        note: document.getElementById('note').value, monthKey: date.slice(0,7)
      };
      const d = loadData();
      const idx = d.findIndex(r => r.id === id);
      if(idx>=0) d[idx]=entry; else d.push(entry);
      saveData(d); clearForm(); init(); showToast('Saved');
    });

    window.edit = (id) => {
      const r = loadData().find(d=>d.id===id); if(!r) return;
      document.getElementById('editingId').value=r.id; document.getElementById('date').value=r.date; document.getElementById('time').value=r.time;
      document.getElementById('childName').value=r.childName; document.getElementById('crm').value=r.crm;
      document.getElementById('course').value=r.course; document.getElementById('buyOrNot').value=r.buyOrNot;
      document.getElementById('revenue').value=r.revenue; document.getElementById('layer').value=r.layer;
      document.getElementById('note').value=r.note;
      document.getElementById('formTitle').innerHTML=`<span class="text-blue-400">‚úèÔ∏è</span> Edit`;
      document.getElementById('duplicateBtn').classList.remove('hidden');
      document.getElementById('duplicateBtn').onclick = () => { saveData([...loadData(), {...r, id:uid()}]); init(); showToast('Duplicated'); };
    };

    window.del = (id) => { if(confirm('Delete?')) { saveData(loadData().filter(r=>r.id!==id)); render(); showToast('Deleted','','üóëÔ∏è'); } };

    function clearForm() { document.getElementById('entryForm').reset(); document.getElementById('editingId').value=''; document.getElementById('date').valueAsDate=new Date(); document.getElementById('formTitle').textContent='New Record'; document.getElementById('duplicateBtn').classList.add('hidden'); }

    document.addEventListener('DOMContentLoaded', init);
    ['monthSelector','periodFilter','courseFilter','searchInput'].forEach(id=>document.getElementById(id).addEventListener(id==='searchInput'?'input':'change',render));
    document.getElementById('refreshBtn').addEventListener('click', ()=> { render(); showToast('Refreshed'); });
    document.getElementById('clearFormBtn').addEventListener('click', clearForm);
    const menu=document.getElementById('menu'); document.getElementById('menuBtn').addEventListener('click',e=>{e.stopPropagation();menu.classList.toggle('hidden');}); document.addEventListener('click',e=>{if(!menu.contains(e.target))menu.classList.add('hidden');});

    const tglModal=(id,s)=>{ const m=document.getElementById(id), b=document.getElementById('modalBackdrop'); if(s){m.classList.remove('hidden');b.classList.remove('hidden');}else{m.classList.add('hidden');b.classList.add('hidden');}};
    document.getElementById('targetBtn').addEventListener('click', ()=>{ tglModal('targetModal',1); const t=getTarget(); document.getElementById('targetInput').value=t?t.val:''; });
    document.getElementById('saveTargetBtn').addEventListener('click', ()=>{ saveTarget(els.month.value,document.getElementById('targetInput').value); tglModal('targetModal',0); render(); });
    document.getElementById('cancelTargetBtn').addEventListener('click', ()=>tglModal('targetModal',0));
    document.getElementById('chartBtn').addEventListener('click', ()=>{ tglModal('chartModal',1); const d=loadData(); const c={Buy:0,Not:0,Pending:0}; d.forEach(r=>{if(c[r.buyOrNot]!==undefined)c[r.buyOrNot]++;}); const t=d.length||1; document.getElementById('statusChart').innerHTML=`<div class="w-1/3 bg-emerald-500/20 h-[${(c.Buy/t)*100}%] min-h-[20px] rounded-t relative"><span class="absolute -top-5 w-full text-center text-xs text-emerald-400 font-bold">${c.Buy}</span></div><div class="w-1/3 bg-rose-500/20 h-[${(c.Not/t)*100}%] min-h-[20px] rounded-t relative"><span class="absolute -top-5 w-full text-center text-xs text-rose-400 font-bold">${c.Not}</span></div><div class="w-1/3 bg-amber-500/20 h-[${(c.Pending/t)*100}%] min-h-[20px] rounded-t relative"><span class="absolute -top-5 w-full text-center text-xs text-amber-400 font-bold">${c.Pending}</span></div>`; });
    document.getElementById('closeChartBtn').addEventListener('click', ()=>tglModal('chartModal',0));
    document.getElementById('resetBtn').addEventListener('click', ()=>tglModal('pwModal',1)); document.getElementById('cancelPwBtn').addEventListener('click', ()=>tglModal('pwModal',0));
    document.getElementById('confirmPwBtn').addEventListener('click', ()=>{ if(document.getElementById('pwInput').value===RESET_PASSWORD){localStorage.clear();location.reload();}else showToast('Wrong PW','','‚õî'); });
    document.getElementById('exportAllBtn').addEventListener('click', ()=>{ const d=loadData(); if(!d.length)return; const h=Object.keys(d[0]).join(','); const r=d.map(x=>Object.values(x).map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')); const a=document.createElement('a'); a.href=URL.createObjectURL(new Blob([h+'\n'+r.join('\n')],{type:'text/csv'})); a.download='MiRaj_Data.csv'; a.click(); });
    document.getElementById('importBtn').addEventListener('click', ()=>tglModal('importModal',1)); document.getElementById('cancelImportBtn').addEventListener('click', ()=>tglModal('importModal',0));
    document.getElementById('confirmImportBtn').addEventListener('click', ()=>{ const f=document.getElementById('importFile').files[0]; if(!f)return; const r=new FileReader(); r.onload=e=>{ const l=e.target.result.split('\n'), h=l[0].split(',').map(x=>x.trim()), n=[]; for(let i=1;i<l.length;i++){ if(!l[i].trim())continue; const v=l[i].match(/(".*?"|[^,]+)(?=\s*,|\s*$)/g).map(x=>x.replace(/^"|"$/g,'').replace(/""/g,'"')); const o={}; h.forEach((k,x)=>o[k]=v[x]||''); if(o.id)n.push(o); } saveData([...loadData(),...n]); tglModal('importModal',0); init(); showToast('Imported'); }; r.readAsText(f); });
    document.getElementById('selectAll').addEventListener('change', e=>{ document.querySelectorAll('.row-cb').forEach(c=>{c.checked=e.target.checked; e.target.checked?selRows.add(c.dataset.id):selRows.delete(c.dataset.id);}); updateBulk(); });
    document.getElementById('bulkDeleteBtn').addEventListener('click', ()=>{ if(confirm('Delete selected?')){ saveData(loadData().filter(r=>!selRows.has(r.id))); selRows.clear(); document.getElementById('selectAll').checked=false; render(); }});
    document.querySelectorAll('[data-sort]').forEach(el=>el.addEventListener('click',()=>{ curSort.dir=(curSort.col===el.dataset.sort && curSort.dir==='desc')?'asc':'desc'; curSort.col=el.dataset.sort; render(); }));
  </script>
</body>
</html>
```
